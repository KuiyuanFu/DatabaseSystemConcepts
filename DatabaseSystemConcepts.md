​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

## 第1章 引言

- **数据库管理系统**（DataBase-Management System，DBMS）：由互相关联的**数据的集合**和一组用以访问这些数据的**程序**组成。
- **数据库**（databse）：这个数据集合。

### 1.1 数据库系统的应用

所有需要存储格式化数据的应用都可以使用数据库系统。

### 1.2 数据库系统的目标

- **文件处理系统**（file-processing system）：永久记录被存储在多个不同的文件中，编写不同的应用程序来将记录从有关文件中取出或加入到适当的文件中。

文件处理系统的弊端：

- **数据的冗余和不一致**（data redundancy and inconsistency）：同一数据在不同位置**出现多次**，同一数据的**不同副本不一致**。
- **数据访问困难**（difficulty in accessing data）：不支持一种方便高效的方式其获取所需数据。
- **数据孤立**（data isolation）：由于数据分散在不同文件，格式可能不同，检索数据很困难。
- **完整性问题**（integrity problem）：数据库中存储的值必须满足特定的**一致性约束**（consistency constraint）。
- **原子性问题**（atomicity problem）：当计算机系统发生故障，数据需要恢复到故障发生前一致的状态。操作必须是**原子的**，即要么全部发生，要么根本不发生。
- **并发访问异常**（concurrent-access anomaly）：系统允许多个用户同时更新数据，可能**导致数据不一致**。
- **安全性问题**（security problem）：需要访问控制，不是所有人都可以访问数据。



### 1.3 数据视图

数据库系统的一个主要目的是给用户提供**数据的抽象视图**。

#### 1.3.1 数据抽象

- **物理层**（physical level）：最低层次的抽象，描述数据实际上怎么存储的。详细描述复杂的底层数据结构。

- **逻辑层**（logical level）：比物理层稍高的抽象，描述数据库中存储什么数据，及这些数据间存在什么关系。逻辑层通过少量相对简单的结构描述了整个数据库，不需要知道复杂的物理层结构，称为**物理数据独立性**（physical data independence）。

- **视图层**（view level）：最高层次的抽象，只描述整个数据库的某个部分，简单，只关注需要访问的一部分。

#### 1.3.2 实例和模式

- **实例**（instance）：特定时刻存储在数据库中的信息的集合。

- **模式**（schema）：数据库的总体设计。

根据数据抽象层次，可以分为几种不同的模式：

- **物理模式**（physical schema）：在物理层描述数据库的设计。

- **逻辑模式**（logical schema）：在逻辑层描述数据库的设计。

- **子模式**（subschema）：在视图层可以有多种模式描述数据库的设计。



- **数据物理独立性**（physical data independence）：应用程序不依赖于物理模式。

#### 1.3.3 数据模型

- **数据模型**（data model）：描述数据、数据联系、数据语义及一致性约束的**概念工具的集合**，提供了一种描述物理层、逻辑层以及视图层数据库设计的方式。

数据模型可被分为四类：

- **关系模型**（relational model）：用**表的集合**表示数据和数据间的关系。

- **实体联系模型**（entity-relationship model，E-R model）：基于对现实世界的一种认识，即现实世界由一组**称为实体的基本对象**，以及这些对象之间的**联系**构成。

- **基于对象的数据模型**（object-based data model）：**对E-R模型**增加封装、方法和对象标识等概念后**的扩展**。

- **半结构化数据模型**（semistructured data model）：允许相同类型的数据项含有不同的属性集的数据定义。**可扩展标记语言**（eXtensible Markup Language，XML）用来表示半结构化数据。

### 1.4 数据库语言

- **数据定义语言**（data-definition language）：定义数据库模式。

- **数据操纵语言**（data-manipulation language）：表达数据库的查询和更新。

#### 1.4.1数据操纵语言

可以使得用户可以**访问或操纵**那些按照某种适当的**数据模型**组织起来的**数据**。

访问类型：

- 对存储在数据库中的信息进行**检索**。
- 向数据库中**插入**新的信息。
- 从数据库中**删除**信息。
- **修改**数据库中存储的信息。

两类**基本的数据操纵语言**：

- **过程化 DML**（procedural DML）：要求用户指定**需要什么数据**，以及**如何获得**这些数据。

- **声明式 DML**（declarative DML）：也称**非过程化 DML**。只要求用户指定**需要什么数据**。

通常**声明式 DML** 比过程化 DML **更易学易用**。但是需要数据库系统找出**访问数据的高效途径**。

- **查询**（query）：要求对信息进行**检索**的语句。实践中，把**查询语言**和**数据操纵语言**当作**同义词**。

#### 1.4.1数据定义语言

表达**数据库模式的一系列定义**。

- **数据存储和定义语言**（data storage and definition language）：**一系列特殊的 DDL 语句**，说明数据库系统所使用的**存储结构**和**访问方式**。定义了数据库模式的实现细节，而这些细节对用户来说通常是不可见的。

存储在数据库中的数据必须满足某些**一致性约束**。

- **域约束**（domain constraint）：每个属性对应于一个**所有可能取值构成的域**。

- **参照完整性**（referential integrity）：**一个关系**中给定**属性集**上**的取值**，**在另一关系**的某一**属性集**的**取值中出现**。

- **断言**（saaertion）：数据库需要**持续满足的某一条件**。**域约束**和**参照完整性**是**特殊的断言**。

- **授权**（authorization）：**对于不同的用户**在数据库中的不同数据值上**允许不同的访问类型**。
  - **读权限**（read authorization）：允许读取数据。
  - **插入权限**（insert authorization）：允许插入新数据。
  - **更新权限**（update authorization）：允许修改数据。
  - **删除权限**（delete authorization）：允许删除数据。

DDL 以一些指令作为输入，生成一些输出。输出放在**数据字典**（data dictionary）中，数据字典包含了**元数据**（matedata），元数据是关于数据的数据。

可以把**数据字典看作是一种特殊的表**，这个表只能由数**据库系统本身来访问和修改**。在操作实际的数据前，数据库系统先要参考数据字典。

### 1.5 关系数据库

关系数据库**基于联系模型**，使用一系列**表**来表示**数据**以及这些数据之间的**关系**。

#### 1.5.1 表

每个表有多个列，每个列有唯一的名字。

**关系模型**是**记录**的**模型**的**一个实例**。

数据库的结构是**几种固定格式的记录**。

每个**表**包含一种特定类型的**记录**。

每种**记录**类型定义固定数目的**字段或属性**。

表的**列**对应记录类型的**属性**。

#### 1.5.2 数据操纵语言

SQl查询语言是**非过程化的 DML**。

以几个表作为输入，但**总是返回一个表**。

#### 1.5.3 数据定义语言

SQL 提供了丰富的 DLL 语言，可以定义表、完整性约束、断言。

#### 1.5.4 来自应用程序的数据库访问

**SQL 不是图灵完备的**。一些计算可以用通用的程序设计语言来表达，但无法通过 SQL 来表达。

- **应用程序**（application program）：用一种**宿主语言**来编写的，执行SQL**不能表达的操作**的，与**数据库进行交互**的程序。

两种实现方式：

- **应用程序接口**：将 DML 与 DDL 语句发送给数据库，再取回结果。
- **扩展宿主语言语法**：在宿主语言的程序中嵌入 DML 调用。使用一个特殊关键字作为 DML 调用的开始，并且通过 **DML 预处理器**，将 DML 语言转化为宿主语言中的过程调用。

### 1.6 数据库设计

数据库对终端产品应用起到**支撑作用**。

数据库设计主要是**数据库模式的设计**。

#### 1.6.1 设计过程

高层的**数据模型**提供了**概念框架**，说明了数据库用户的**数据需求**，机器如何构造**数据库结构**。



- **数据需求**（data requirement）：全面刻画**预期的**数据库用户的**数据需求**。
- **概念设计**（conceptual-design）：选择一个**数据模型**，将**需求**转换成一个数据库的**概念模式**，重点描述**数据**以及它们之间的**关系**，即**元素**以及如何组织成**表**。
- **功能需求说明**（specification of functioanl requirement）：描述数据之上的**各种操作**。
- **逻辑设计**（logical-design）：将高层的**概念模式**，**映射**到要使用的数据库系统的**实现数据模型**上。
- **物理设计**（physical-design）：指定数据库的**物理特性**，包括文件组织形式及内部存储结构。

#### 1.6.3 实体-联系模型

- **实体**（entity）：现实世界中可以**区别于**其他对象的一件**事情**或者一个**物体**。
  - **属性**（attribute）：实体的属性，**实体通过属性来区分**。
  - **实体集**（entity set）：同一类型的所有实体的集合。
- **联系**（relationship）：是几个实体之间的**关联**。
  - **联系集**（relationship set）：同一类型所有联系的集合。

- **统一建模语言**（Unified Modeling Language，UML）：图形化表示数据库的总体逻辑结构的一种**方法**。**实体集**用**矩形框**表示，实体名在头部，属性名列在下面；**联系集**用链接一对相关实体集的**菱形**表示，联系名放在菱形内部。

  - **映射基数**（mapping cardinality）：表示通过某个联系集能与一实体进行关联的**实体数目**。

  

#### 1.6.4 规范化

- **规范化**（normalization）：生成一个关系模式集合，使其**无冗余**，**容易检索**。设计一种符合适当范式的模型。
  - **函数依赖**（functional dependency）：一种规范化的方法。

### 1.7 数据存储和查询

数据库系统可分为**存储管理器**和**查询处理**。

#### 1.7.1 存储管理器

负责在数据库中存储的**底层数据结构**与**应用程序**以及向系统**提交的查询**之间**提供接口的部件**。

将DML语言**翻译**为底层文件系统命令。

- **权限及完整性管理器**（authorization and integrity manager）：检测权限及完整性约束。
- **事务管理器**（transaction manager）：保证数据库一致性，并发无冲突。
- **文件管理器**（file manager）：管理磁盘空间的分配，存储信息的数据结构。
- **缓冲区管理器**（buffer manager）：从磁盘缓冲数据，关键部分。
- **数据文件**（data files）：存储数据库自身。
- **数据字典**（data dictionary）：存储关于数据库结构的元数据，尤其是数据库模式。
- **索引**（index）：提供对数据项的快速访问。



#### 1.7.2 查询处理器

- **DDL 解释器**（DDL interpreter）：解释 DDL 语句并将这些定义记录在数据字典中。

- **DML 编译器**（DML compiler）：将查询语句中DML语句翻译为一个执行方案，包括一系列低级指令。

- **查询执行引擎**（query evaluation engine）：执行由 DML 编译器翻译出的低级指令。

  

### 1.8 事务管理

- **事务**（transaction）：完成单一逻辑功能的操作集合，满足原子性，一致性。
  - **原子性**（atomicity）：要么完成，要么不发生。
  - **一致性**（consistency）：满足一定约束。
  - **持久性**（durability）：完成后，要持久保持新值。
- **事务管理器**（transaction manager）：管理事务。
  - **恢复管理器**（recovery manager）：负责原子性和持久性。
    - **故障恢复**（failure recovery）：当事务执行失败时，将数据库恢复到故障发生之前。
  - **并发控制管理器**（concurrency-control manager）：控制并发事务之间的相互影响。

### 1.9 数据库体系结构

整体调用结构：

- **用户**。

- **应用**。

- **查询管理器**。

- **存储管理器**。

- **磁盘存储**。

  

两个层次：

- **客户机**（client）：通过查询语言调用服务器上的数据库系统功能。

- **服务器**（server）：提供数据库服务。

### 1.10 数据挖掘与信息检索

- **数据挖掘**（data mining）：半自动分析大型数据库，从中找到有用的模式的过程。

- **信息检索**（information retrieval）：查询非结构化的文本数据。

### 1.11 特种数据库

处理特殊应用领域的数据库系统，包括**基于对象的数据模型**和**半结构化数据模型**。



#### 1.11.1 基于对象的数据模型

- **基于对象的数据模型**（object-based data model）：由于面向对象程序设计占统治地位，导致其发展。可以看作 E-R 模型的扩展，增加封装、方法和对象标识。
  - **对象-关系模型**（object-relation data model）：将**基于对象的数据模型**和**关系数据模型**特点结合在一起的数据模型。

#### 1.11.2 半结构化数据模型

**半结构化数据模型**允许**相同类型的数据**有**不同的属性集的数据说明**。

XML 语言支持嵌套结构，很有效。

### 1.12 数据库用户和管理员

#### 1.12.1 数据库用户和用户界面

根据数据库用户的水平及交互方式，可分为：

- **无经验的用户**（naive user）：默认用户，激活应用程序进行交互。
- **应用程序员**（application programmer）：编写应用程序的计算机专业人员。
  - **快速应用开发**（Rapid Application Development，RAD）：专用工具，使程序员可以**尽量少编写程序**就可以构造出**表格**和**报表**的工具。
- **老练的用户**（sophisticated user）：直接使用数据库查询语言或分析软件。
- **专门的用户**（specialized user）：编写数据库应用本身的富有经验的用户。

#### 1.12.2 数据库管理员

- **数据库管理员**（DataBase Administrator，DBA）：对系统进行集中控制的人。

  - **模式定义**（schema definition）：通过DDL定义来创建最初的数据库模式。
  - **存储结构及存取方法定义**（storage structure and access-method definition）。
  - **模式及物理组织的修改**（schema and phsical-organization modification）：修改，以反应机构需求的变化，或提高性能。
  - **数据库访问授权**（granting of authorization for data access）。
  - **日常维护**（routine maintenance）：
    - **定期备份**。
    - **磁盘空间管理**。
    - **性能监控**。

